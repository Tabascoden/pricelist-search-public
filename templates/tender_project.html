{% extends 'base.html' %}
{% block content %}
<div class="card" id="tender-project" data-project-id="{{ project_id }}">
  <div class="cardHeader tender-flex">
    <div>
      <h1>Тендер #{{ project_id }}</h1>
      <div class="sub">Загрузка позиций и подбор предложений</div>
    </div>
    <div class="tender-flex tender-actions">
      <input type="file" id="tender-upload" accept=".xlsx" style="min-width:200px;">
      <button class="btn" id="tender-upload-btn">Загрузить</button>
      <button class="btn" id="tender-autopick">Автоподбор</button>
      <button class="btn primary" id="tender-export">Экспорт</button>
    </div>
  </div>
  <div id="tender-items" class="tender-table-wrap">Загрузка...</div>
</div>

<div class="tender-modal hidden" id="tender-modal">
  <div class="tender-modal-body">
    <div class="tender-modal-header">
      <h3 id="tender-modal-title">Предложения</h3>
      <button class="btn" id="tender-modal-close">Закрыть</button>
    </div>
    <div id="tender-modal-content" class="tender-table-wrap"></div>
  </div>
</div>

<style>
  .tender-flex { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
  .tender-form { margin-left: auto; }
  .tender-table-wrap { width: 100%; }
  .tender-row { display: grid; grid-template-columns: 1.4fr 0.5fr 0.8fr 1.2fr 0.6fr; gap: 12px; align-items: center; padding: 12px; border-bottom: 1px solid var(--border); }
  .tender-head { font-weight: 700; font-size: 13px; text-transform: uppercase; color: #475569; background: #f8fafc; }
  .tender-row:nth-child(even) { background: #f8fafc; }
  .tender-offer { font-size: 13px; color: #334155; }
  .tender-offer strong { display: block; }
  .tender-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.35); display: flex; align-items: center; justify-content: center; z-index: 100; }
  .tender-modal-body { background: #fff; border-radius: 14px; padding: 16px; width: min(900px, 95vw); box-shadow: var(--shadow); }
  .tender-modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
  .tender-offers-table { width: 100%; border-collapse: collapse; }
  .tender-offers-table th, .tender-offers-table td { padding: 10px 12px; border-bottom: 1px solid var(--border); text-align: left; }
  .tender-offers-table th { background: #f8fafc; font-size: 12px; text-transform: uppercase; color: #475569; }
  .tender-tag { display: inline-flex; align-items: center; padding: 4px 8px; border-radius: 999px; background: #eef2ff; color: #312e81; font-size: 12px; font-weight: 700; margin-top: 4px; }
  @media (max-width: 900px) {
    .tender-row { grid-template-columns: 1fr; }
  }
</style>

<script src="/static/tenders.js"></script>
<script>
  window.tenderProjectPage = true;
</script>
{% endblock %}
