{% extends "base.html" %}
{% block content %}

<div class="card" id="tenders-demo">
  <div class="cardHeader">
    <div>
      <h2>–¢–µ–Ω–¥–µ—Ä—ã</h2>
      <div class="sub">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ç–µ–Ω–¥–µ—Ä—ã –∏ –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ Excel/CSV –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.</div>
    </div>
    <div class="right">
      <form class="tender-form" id="tenders-upload-form" enctype="multipart/form-data">
        <input class="input" type="text" name="title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–Ω–¥–µ—Ä–∞" required />
        <label class="btn tender-file-btn">
          üìÅ <span>–§–∞–π–ª</span>
          <input id="tenders-file-input" type="file" name="file" required />
        </label>
        <button class="btn primary" type="submit">–°–æ–∑–¥–∞—Ç—å –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
      </form>
      <div class="tender-file-name" id="tenders-file-name">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</div>
    </div>
  </div>

  <div id="tenders-view-list">
    <div class="tableWrap">
      <table>
        <thead>
          <tr>
            <th style="width:120px;">ID</th>
            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th style="width:160px;">–ü–æ–∑–∏—Ü–∏–∏</th>
            <th style="width:200px;">–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody id="tenders-list-body">
          <tr>
            <td colspan="4" style="text-align:center; padding:40px; color:var(--text-muted)">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div id="tenders-view-project" class="hidden">
    <div class="tender-topbar">
      <div class="tender-title">
        <div class="h2" id="tenders-project-title">–¢–µ–Ω–¥–µ—Ä</div>
        <div class="tender-hint" id="tenders-project-meta"></div>
      </div>

      <div class="tender-actions">
        <div class="tender-dropdown-wrap">
          <button class="btn" id="tenders-pick-suppliers-btn" type="button">–í—ã–±—Ä–∞—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤</button>
          <div class="tender-dropdown hidden" id="tenders-suppliers-dropdown">
            <div class="tender-dropdown-header">
              <div class="h3">–í—ã–±–æ—Ä –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</div>
              <button class="btn" id="tenders-suppliers-close" type="button">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
            <div class="tender-dropdown-controls">
              <label class="tender-control">
                <div class="tender-control-title">–ü–æ–∏—Å–∫</div>
                <input class="input" id="tenders-suppliers-search" placeholder="–ù–∞—á–Ω–∏ –≤–≤–æ–¥–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ..." />
              </label>
            </div>
            <div class="suppliersList" id="tenders-suppliers-list"></div>
            <div class="suppliersActions">
              <button class="btn" id="tenders-suppliers-clear" type="button">–°–Ω—è—Ç—å –≤—Å—ë</button>
              <button class="btn primary" id="tenders-suppliers-apply" type="button">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
          </div>
        </div>
        <button class="btn primary" id="tenders-build-orders-btn">–°–æ–±—Ä–∞—Ç—å –∑–∞–∫–∞–∑(—ã)</button>
        <button class="btn" id="tenders-export-btn">–≠–∫—Å–ø–æ—Ä—Ç</button>
        <button class="btn danger" id="tenders-delete-btn">–£–¥–∞–ª–∏—Ç—å —Ç–µ–Ω–¥–µ—Ä</button>
      </div>
    </div>

    <div id="tenders-selected-suppliers" class="tender-legend"></div>

    <div class="tender-add" style="margin-top:10px;">
      <div class="tender-add-title">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –≤—Ä—É—á–Ω—É—é</div>
      <form class="tender-add-form" id="tenders-add-item-form">
        <input class="input" id="tenders-add-name" placeholder="–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞" required />
        <input class="input input-qty" id="tenders-add-qty" type="number" min="0" step="0.001" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" />
        <input class="input input-unit" id="tenders-add-unit" placeholder="–ï–¥." />
        <button class="btn" type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
      </form>
    </div>

    <div class="tender-grid" style="margin-top:12px;">
      <table id="tenders-project-table"></table>
    </div>

    <div class="card" style="margin-top:14px;">
      <div class="cartTop">
        <div>
          <div class="cartTitle">–ö–æ—Ä–∑–∏–Ω–∞</div>
          <div class="cartSub">–ó–µ–ª—ë–Ω–∞—è –∑–≤–µ–∑–¥–∞ = –ø–æ–∑–∏—Ü–∏—è –≤—ã–±—Ä–∞–Ω–∞ –≤ –∑–∞–∫–∞–∑. –ú–æ–∂–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤.</div>
        </div>
        <div class="cartActions" id="tenders-cart-actions"></div>
      </div>

      <div id="tenders-cart"></div>
      <div style="margin-top:10px;" id="tenders-totals"></div>
      <div style="margin-top:10px;" id="tenders-orders"></div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –ø–æ–¥–±–æ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ -->
  <div class="tender-modal hidden" id="tenders-match-modal">
    <div class="tender-modal-body">
      <div class="tender-modal-header">
        <div>
          <div class="h3" id="tenders-match-title">–ü–æ–¥–±–æ—Ä –ø–æ–∑–∏—Ü–∏–∏</div>
          <div class="tender-hint" id="tenders-match-sub"></div>
        </div>
        <button class="btn" id="tenders-match-close">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>

      <div class="tender-hint" style="margin-top:6px;">
        –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ <b>score</b> (–ø–æ—Ö–æ–∂–µ—Å—Ç—å) ‚Üì, –∑–∞—Ç–µ–º –ø–æ —Ü–µ–Ω–µ ‚Üë. –í—Å—ë –Ω–∏–∂–µ 0.30 –æ–±—ã—á–Ω–æ –º—É—Å–æ—Ä.
      </div>

      <div class="tender-match-search" style="margin-top:10px;">
        <label class="tender-control" style="flex:1 1 260px;">
          <div class="tender-control-title">–†—É—á–Ω–æ–π –ø–æ–∏—Å–∫</div>
          <input class="input" id="tenders-match-search" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ñ–∏–ª–µ –∫—É—Ä–∏–Ω–æ–µ –æ—Ö–ª–∞–∂–¥—ë–Ω–Ω–æ–µ" />
        </label>
        <button class="btn" id="tenders-match-search-btn" type="button">–ù–∞–π—Ç–∏</button>
      </div>

      <div style="margin-top:10px;">
        <table class="tender-offers-table" style="width:100%;">
          <thead>
            <tr>
              <th style="width:80px;">Score</th>
              <th>–¢–æ–≤–∞—Ä —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</th>
              <th style="width:120px;">–¶–µ–Ω–∞/–µ–¥.</th>
              <th style="width:120px;">–°—É–º–º–∞</th>
              <th style="width:120px;">–î–µ–π—Å—Ç–≤–∏–µ</th>
            </tr>
          </thead>
          <tbody id="tenders-match-body"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<style>
  #tenders-demo .hidden { display:none !important; }
  #tenders-demo .tender-form { display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end; }
  #tenders-demo .tender-file-btn { position: relative; overflow: hidden; }
  #tenders-demo .tender-file-btn input[type="file"] { position: absolute; inset: 0; opacity: 0; cursor: pointer; }
  #tenders-demo .tender-file-name { font-size: 12px; color: #64748b; margin-top: 8px; text-align: right; }
  #tenders-demo .tender-actions-row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
  #tenders-demo .tender-topbar { display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap; }
  #tenders-demo .tender-title { flex: 1 1 auto; min-width: 240px; }
  #tenders-demo .h2 { font-size: 20px; font-weight: 800; }
  #tenders-demo .h3 { font-size: 16px; font-weight: 800; }
  #tenders-demo .tender-actions { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  #tenders-demo .tender-hint { color:#64748b; font-size: 13px; }
  #tenders-demo .tender-grid { width:100%; overflow-x:auto; overflow-y:hidden; }
  #tenders-demo .tender-grid table { width:100%; border-collapse: collapse; }
  #tenders-demo .tender-grid th, #tenders-demo .tender-grid td { border-bottom: 1px solid #e2e8f0; padding: 10px; vertical-align: top; }
  #tenders-demo .tender-grid thead th { position: sticky; top: 0; background: #f8fafc; z-index: 1; font-size:12px; text-transform: uppercase; color:#475569; }
  #tenders-demo .tender-dropdown-wrap { position: relative; }
  #tenders-demo .tender-dropdown { position: absolute; top: calc(100% + 8px); right: 0; width: 420px; background: #fff; border: 1px solid #e2e8f0; border-radius: 14px; box-shadow: 0 16px 30px rgba(15, 23, 42, 0.12); padding: 12px; z-index: 20; }
  #tenders-demo .tender-dropdown-header { display:flex; align-items:center; justify-content:space-between; gap:10px; }
  #tenders-demo .tender-dropdown-controls { margin-top: 8px; }

  #tenders-demo .tender-modal { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.5); display:flex; align-items:center; justify-content:center; padding: 20px; z-index: 30; }
  #tenders-demo .tender-modal-body { background: #fff; border-radius: 16px; padding: 16px; max-width: 900px; width: min(900px, 100%); max-height: 85vh; overflow: auto; box-shadow: 0 18px 35px rgba(15, 23, 42, 0.2); }
  #tenders-demo .tender-modal-header { display:flex; align-items:center; justify-content:space-between; gap:12px; }
  #tenders-demo .tender-match-search { display:flex; gap:10px; align-items:flex-end; flex-wrap:wrap; }

  #tenders-demo .supplierTh { width: 260px; min-width:260px; }
  #tenders-demo .supplierCell { width: 260px; min-width:260px; }
  #tenders-demo .supplierCell .supName { font-weight: 700; line-height: 1.25; }
  #tenders-demo .supplierCell .supMeta { margin-top: 4px; display:flex; gap:10px; flex-wrap:wrap; align-items:baseline; }
  #tenders-demo .supplierCell .supPrice { font-weight: 900; }
  #tenders-demo .supplierCell .supScore { color:#64748b; font-size: 12px; }
  #tenders-demo .supplierCell .supEmpty { height: 18px; }
  #tenders-demo .iconRow { display:flex; gap:8px; margin-top: 8px; }
  #tenders-demo .iconBtn { width:28px; height:28px; display:inline-flex; align-items:center; justify-content:center; border:1px solid #e2e8f0; background:white; border-radius:8px; cursor:pointer; }
  #tenders-demo .iconBtn:hover { background:#f8fafc; }
  #tenders-demo .iconBtn:disabled { opacity:.45; cursor:not-allowed; }
  #tenders-demo .iconBtn.star-picked { background:#22c55e; border-color:#22c55e; color:white; }
  #tenders-demo .iconBtn.star-picked:hover { background:#16a34a; border-color:#16a34a; }

  #tenders-demo .supplierCell.picked { background: #ecfdf5; outline: 2px solid #34d399; outline-offset: -2px; border-radius: 10px; }
  #tenders-demo .supplierCell.best:not(.picked) { background: #fffbeb; outline: 2px solid #fbbf24; outline-offset: -2px; border-radius: 10px; }

  #tenders-demo .cartTop { display:flex; gap:12px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap; }
  #tenders-demo .cartTitle { font-weight: 900; }
  #tenders-demo .cartSub { color:#64748b; font-size: 13px; }

  #tenders-demo .cartTable { width:100%; border-collapse: collapse; margin-top: 10px; }
  #tenders-demo .cartTable th, #tenders-demo .cartTable td { border-bottom: 1px solid #e2e8f0; padding: 10px; vertical-align: top; }
  #tenders-demo .cartTable th { background:#f8fafc; font-size: 12px; text-transform: uppercase; color:#475569; }

  #tenders-demo .totalsGrid { display:grid; grid-template-columns: 1fr; gap:10px; }
  #tenders-demo .totalsGrid table { width:100%; border-collapse: collapse; }
  #tenders-demo .totalsGrid th, #tenders-demo .totalsGrid td { border-bottom: 1px solid #e2e8f0; padding: 10px; vertical-align: top; }
  #tenders-demo .totalsGrid th { background:#f8fafc; font-size: 12px; text-transform: uppercase; color:#475569; }

  #tenders-demo .suppliersList { display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:12px; }
  #tenders-demo .suppliersItem { border:1px solid #e2e8f0; border-radius: 12px; padding: 10px; display:flex; gap:10px; align-items:flex-start; }
  #tenders-demo .suppliersItem input { transform: translateY(2px); }
  #tenders-demo .suppliersActions { display:flex; gap:10px; justify-content:flex-end; margin-top: 12px; }
  #tenders-demo .tender-add { border:1px solid #e2e8f0; border-radius: 12px; padding: 12px; background:#fff; }
  #tenders-demo .tender-add-title { font-weight: 700; margin-bottom: 8px; }
  #tenders-demo .tender-add-form { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
  #tenders-demo .input-qty { width: 140px; }
  #tenders-demo .input-unit { width: 90px; }

  @media (max-width: 880px){
    #tenders-demo .tender-form { width: 100%; justify-content:flex-end; }
    #tenders-demo .tender-file-name { text-align: left; }
    #tenders-demo .tender-dropdown { position: static; width: 100%; box-shadow: none; margin-top: 10px; }
    #tenders-demo .suppliersList { grid-template-columns: 1fr; }
  }
</style>

<script src="/static/tenders.js" defer></script>
{% endblock %}
